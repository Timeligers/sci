<?xml version="1.0" encoding="UTF-8"?>
<!--
 * Scilab ( https://www.scilab.org/ ) - This file is part of Scilab
 * Copyright (C) ENPC - Jean-Philippe Chancelier
 * Copyright (C) 2012 - 2016 - Scilab Enterprises
 * Copyright (C) 2021 - Samuel GOUGEON
 *
 * This file is hereby licensed under the terms of the GNU GPL v2.0,
 * pursuant to article 5.3.4 of the CeCILL v.2.1.
 * This file was originally licensed under the terms of the CeCILL v2.1,
 * and continues to be available under such terms.
 * For more information, see the COPYING file which you should have received
 * along with this program.
 *
 -->
<refentry xmlns="http://docbook.org/ns/docbook" xmlns:xlink="http://www.w3.org/1999/xlink"
          xmlns:svg="http://www.w3.org/2000/svg" xmlns:mml="http://www.w3.org/1998/Math/MathML"
          xmlns:db="http://docbook.org/ns/docbook" xmlns:scilab="http://www.scilab.org"
          xml:lang="en" xml:id="xsetech">
    <refnamediv>
        <refname>xsetech</refname>
        <refpurpose>
            sets and initializes an axes anywhere in the current figure or uiframe
        </refpurpose>
    </refnamediv>
    <refsynopsisdiv>
        <title>Syntax</title>
        <synopsis>
            xsetech
            xsetech(axes_bounds)
            xsetech(axes_bounds, data_bounds)
            xsetech(axes_bounds, data_bounds, logflag)
            xsetech(axes_bounds, data_bounds, logflag, margins)
        </synopsis>
    </refsynopsisdiv>
    <refsection>
        <title>Arguments</title>
        <variablelist>
            <varlistentry>
                <term>axes_bounds</term>
                <listitem>
                    <para>
                        vector <literal>[x, y, width, height]</literal> of normalized coordinates
                        (in [0,1]) specifying the position <literal>[x, y]</literal> and sizes
                        <literal>[width, height]</literal> of the axes overall area, with
                        respect to <literal>gcf().axes_sizes</literal> or to
                        <literal>uiframe.position(3:4)</literal> sizes.
                    </para>
                    <para>
                        <literal>[x,y]</literal> are the normalized coordinates of top-left corner
                        of the axes area, with respect to the top-left corner of the figure or
                        uiframe substrate.
                    </para>
                    <para>
                        Any coordinate specified as <literal>%nan</literal> keeps its current
                        or default value.
                        Default values are <literal>[0 0 1 1]</literal>, covering the whole substrate.
                    </para>
                </listitem>
            </varlistentry>
            <varlistentry>
                <term>data_bounds</term>
                <listitem>
                    <para>
                        vector <literal>[xmin, ymin, xmax, ymax]</literal> initializing
                        <literal>axes.data_bounds=[xmin xmax ymin ymax]</literal>.
                        <warning>
                            Beware about the order of <literal>xmax</literal> and <literal>ymin</literal>.
                        </warning>
                    </para>
                    <para>
                        Any bound specified as <literal>%nan</literal> keeps its current or default
                        value. Default values are <literal>gda().data_bounds([1 3 2 4])</literal>
                        (usually [0 0 1 1]).
                    </para>
                </listitem>
            </varlistentry>
            <varlistentry>
                <term>logflag</term>
                <listitem>
                    2-character flag made of "n" (for normal scale) or
                    "l" (for logarithmic scale). The first character sets
                    the scale for the x axis, the second for the y axis.
                    Example: <literal>"ln"</literal>.
                    <para/>
                    Any margin specified as <literal>%nan</literal> keeps its current or default value.
                    The default value is  <literal>gda().log_flag</literal> (usually "nn").
                </listitem>
            </varlistentry>
            <varlistentry>
                <term>margins</term>
                <listitem>
                    vector <literal>[left, right, above, bellow]</literal> in [0,1] specifying the
                    relative widths or heights or margins around the data area, where the
                    axes ticks labels, the x axis and y axis legends and the overall title
                    are expected.
                    <para/>
                    The default values are <literal>gda().margins</literal> (usually
                    <literal>[1 1 1 1]/8</literal>).
                </listitem>
            </varlistentry>
        </variablelist>
    </refsection>
    <refsection>
        <title>Description</title>
        <para>
            <literal>xsetech(…)</literal> creates or updates an axes anywhere on the substrate of
            the current entity <literal>gce()</literal>, that can be either a uiframe or a figure.
            It is useful
            <itemizedlist>
                <listitem>
                    when the layout of the graphical substrate is not gridable,
                    what prevents using <literal>subplot(…)</literal>.
                </listitem>
                <listitem>
                    when the main properties of the new axes must be set at creation time
                    out of the default values.
                </listitem>
                <listitem>
                    or for instance to define some graphic inset.
                </listitem>
            </itemizedlist>
        </para>
        <para>
            If the graphical area defined by <varname>axes_bounds</varname> matches exactly
            an existing axes, <literal>xsetech(…)</literal> sets it as the current axes and
            updates its properties <literal>.data_bounds</literal>, <literal>.log_flag</literal>
            and <literal>.margins</literal> with other input data (if any).
        </para>
        <para>
            Otherwise, a new axes is created with given input properties. By default,
            <literal>gda()</literal> properties are set.
       </para>
        <para>
            To ignore an input argument and use its default value, just skip it as in
            <literal>xsetech(axes_bounds, , , margins)</literal> where default values
            are used for <literal>data_bounds</literal> and <literal>logflag</literal>.
        </para>
        <para>
            <literal>xsetech(…)</literal> ends by setting the current entity to
            <literal>gca()</literal>.
        </para>
    </refsection>
    <refsection>
        <title>Examples</title>
        <para>
            <emphasis role="bold">Example for a non-gridable graphics layout</emphasis>:
        </para>
        <programlisting role="example"><![CDATA[
clf
title "Main title" fontsize 4

// Top right
xsetech([0.6 0 0.4 0.4])
plot3d

// Middle right
xsetech([0.6 0.4 0.4 0.3])
param3d

// Bottom right, with reduced left/right margins
xsetech([0.4 0.7 0.6 0.28],,,[0.06 0.06 %nan %nan])
plot2d

// Bottom left
xsetech([0 0.7 0.4 0.28])
x = -2:0.05:8;
plot(x, sin(x) + rand(x)/5)

// Top left, with reduced left/right margins
xsetech([0 0.05 0.6 0.65],,,[0.10 0.06 %nan %nan])
histplot, title "", ylabel ""
 ]]></programlisting>
        <scilab:image>
            clf
            title "Main title" fontsize 4

            // Top right
            xsetech([0.6 0 0.4 0.4])
            plot3d

            // Middle right
            xsetech([0.6 0.4 0.4 0.3])
            param3d

            // Bottom right, with reduced left/right margins
            xsetech([0.4 0.7 0.6 0.28],,,[0.06 0.06 %nan %nan])
            plot2d

            // Bottom left
            xsetech([0 0.7 0.4 0.28])
            x = -2:0.05:8;
            plot(x, sin(x) + rand(x)/5)

            // Top left, with reduced left/right margins
            xsetech([0 0.05 0.6 0.65],,,[0.10 0.06 %nan %nan])
            histplot, title "", ylabel ""
        </scilab:image>
        <para/>
        <para>
            <emphasis role="bold">Example to draw a graphic inset</emphasis>:
        </para>
        <programlisting role="example"><![CDATA[
x = linspace(-2,8,1000);
y = sin(x) + rand(x)/20;

clf
plot(x, y)
xgrid(color("grey"))

// Inset
xsetech([0.5 0.13 0.27 0.35])
r = x>=1.2 & x<2;
plot(x(r),y(r))
 ]]></programlisting>
        <scilab:image><![CDATA[
        x = linspace(-2,8,1000);
        y = sin(x) + rand(x)/20;

        clf
        plot(x, y)
        xgrid(color("grey"))

        // Inset
        xsetech([0.5 0.13 0.27 0.35])
        r = x>=1.2 & x<2;
        plot(x(r),y(r))
        gcf().axes_size = [600 380];
     ]]></scilab:image>
        <para/>
        <para>
            <emphasis role="bold">Example on a uiframe</emphasis>:
        </para>
        <programlisting role="example"><![CDATA[
clf
f = gcf();
// Frame = left pannel, full figure's height
fr1 = uicontrol(f, "style", "frame", ..
        "units","normalized","position",[0 0 0.5 1]);

x = -2:0.02:8;

set("current_entity", fr1)
xsetech([0 0 0.7 0.3])  // Width 70% of frame's width
plot(x, sin(x))
xsetech([0 0.3 1 0.3])  // Width 100%
plot(x, cos(x))
xsetech([0 0.6 1.3 0.3]) // Width 130%
plot(x, tan(x))
//gca().background = color("lightcyan");

set("current_entity", f)
subplot(3,2,2)
plot(x, sec(x))

gcf().children
gcf().children(2).type
gcf().children(2).children
 ]]></programlisting>
    <table border="0">
    <tr valign="top">
        <td>
            <screen><![CDATA[
--> gcf().children
 ans  =
3 by 1 matrix of handles:
=========================
Axes
uicontrol
Axes

--> gcf().children(2).type
 ans  =
  "uicontrol"

--> gcf().children(2).children
 ans  =
3 by 1 matrix of handles:
=========================
Axes
Axes
Axes
]]></screen>
        </td>
        <td>
            <inlinemediaobject>
                <imageobject>
                    <imagedata fileref="../../images/xsetech_uiframe.png"/>
                </imageobject>
            </inlinemediaobject>
        </td>
    </tr>
    </table>
    </refsection>
    <refsection role="see also">
        <title>See also</title>
        <simplelist type="inline">
            <member>
                <link linkend="subplot">subplot</link>
            </member>
            <member>
                <link linkend="newaxes">newaxes</link>
            </member>
            <member>
                <link linkend="axes_properties">axes_properties</link>
            </member>
            <member>
                <link linkend="gda">gda</link>
            </member>
        </simplelist>
    </refsection>
    <refsection role="history">
        <title>History</title>
        <revhistory>
            <revision>
                <revnumber>6.1.2</revnumber>
                <revdescription>
                    <itemizedlist>
                        <listitem>
                            xsetech(…) can be used as well on any uiframe substrate.
                        </listitem>
                        <listitem>
                            Any <literal>%nan</literal> value allows to keep the current
                            or default value.
                        </listitem>
                        <listitem>
                            Named input arguments <literal>wrect, frect, arect</literal> are renamed
                            respectively <literal>axes_bounds, data_bounds, margins</literal>.
                        </listitem>
                    </itemizedlist>
                </revdescription>
            </revision>
        </revhistory>
    </refsection>
</refentry>
